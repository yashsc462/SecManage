{% extends 'admin/basead.html' %}

{% block content %}
<head>
    <title>Detailed Quotation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }

        .card {
            width: 95%;
            margin: 2% auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            animation: fadeIn 1s ease-in;
        }

        .card h1 {
            text-align: center;
            color: #333333;
            font-size: 2.5em;
            margin-bottom: 20px;
            animation: slideIn 1s ease-in-out;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .form-group > div {
            flex: 1;
        }

        label {
            font-size: 14px;
            color: #666;
            display: block;
            margin-bottom: 5px;
        }

        input[type="text"],
        input[type="email"],
        input[type="number"],
        textarea {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            width: 100%;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="number"]:focus,
        textarea:focus {
            border-color: #312929;
            outline: none;
            box-shadow: 0 0 8px rgba(49, 41, 41, 0.5);
            transform: scale(1.02);
        }

        button,
    .button-link {
        display: flex;
        align-items: center;
        width: fit-content;
        padding: 10px 20px; /* Using em for relative padding */
        border: none;
        border-radius: 4px;
        background-color: #312929;
        color: #fff;
        font-size: 1rem; /* Use rem for font size for scalability */
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.3s ease;
        text-decoration: none; /* Remove underline for links */
        margin: auto;
    }

    button:hover,
    .button-link:hover {
        background-color: #000000;
        transform: scale(1.05);
    }

    button:active,
    .button-link:active {
        background-color: #2e3741;
    }

        .form-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .form-group > div {
            width: 48%; /* Adjust width to fit two fields in one row */
        }

        .section-heading {
            background-color: #333333;
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        .section-divider {
            border-right: 1px solid #ddd;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #4caf50; /* Green */
            color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            transition: opacity 0.5s ease;
            opacity: 0; /* Initially hidden */
            z-index: 1000; /* Ensure it's on top */
        }

    </style>
</head>

<body>
    <div class="card">
        <h1>Security Guard Quotation</h1>
        <a href="{% url 'quotation' %}" class="button-link">Detailed Quotation</a>
        <form method="post" action="{% url 'security_quotation' %}" onsubmit="showNotification()">
            {% csrf_token %}

            <div class="form-group">
                <div>
                    <label for="company">Company Name:</label>
                    <input type="text" name="company" id="company" required>
                </div>
            </div>

            <!-- Security Guard Section -->
            <div class="section-heading">Security Guard Details</div>
            <div class="form-group">
                <div>
                    <label for="guard_basic_pay">Guard Basic Pay:</label>
                    <input type="text" id="guard_basic_pay" name="guard_basic_pay">
                </div>
                <div>
                    <label for="guard_special_allowance">Guard Special Allowance:</label>
                    <input type="text" id="guard_special_allowance" name="guard_special_allowance">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_total_a">Guard Total A:</label>
                    <input type="text" id="guard_total_a" name="guard_total_a">
                </div>
                <div>
                    <label for="guard_conveyance_allowance">Guard Conveyance Allowance:</label>
                    <input type="text" id="guard_conveyance_allowance" name="guard_conveyance_allowance">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_education_allowance">Guard Education Allowance:</label>
                    <input type="text" id="guard_education_allowance" name="guard_education_allowance">
                </div>
                <div>
                    <label for="guard_travelling_allowance">Guard Travelling Allowance:</label>
                    <input type="text" id="guard_travelling_allowance" name="guard_travelling_allowance">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_house_duty">Guard House Duty:</label>
                    <input type="text" id="guard_house_duty" name="guard_house_duty">
                </div>
                <div>
                    <label for="guard_total_b">Guard Total B:</label>
                    <input type="text" id="guard_total_b" name="guard_total_b">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_washing_allowance">Guard Washing Allowance:</label>
                    <input type="text" id="guard_washing_allowance" name="guard_washing_allowance">
                </div>
                <div>
                    <label for="guard_hra">Guard HRA:</label>
                    <input type="text" id="guard_hra" name="guard_hra">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_sub_total_c">Guard Sub Total C:</label>
                    <input type="text" id="guard_sub_total_c" name="guard_sub_total_c">
                </div>
                <div>
                    <label for="guard_pf">Guard PF:</label>
                    <input type="text" id="guard_pf" name="guard_pf">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_gratuity">Guard Gratuity:</label>
                    <input type="text" id="guard_gratuity" name="guard_gratuity">
                </div>
                <div>
                    <label for="guard_leave_with_wages">Guard Leave with Wages:</label>
                    <input type="text" id="guard_leave_with_wages" name="guard_leave_with_wages">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_esic">Guard ESIC:</label>
                    <input type="text" id="guard_esic" name="guard_esic">
                </div>
                <div>
                    <label for="guard_paid_holiday">Guard Paid Holiday:</label>
                    <input type="text" id="guard_paid_holiday" name="guard_paid_holiday">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_bonus">Guard Bonus:</label>
                    <input type="text" id="guard_bonus" name="guard_bonus">
                </div>
                <div>
                    <label for="guard_uniform">Guard Uniform:</label>
                    <input type="text" id="guard_uniform" name="guard_uniform">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_total_c">Guard Total C:</label>
                    <input type="text" id="guard_total_c" name="guard_total_c">
                </div>
                <div>
                    <label for="guard_service_charges">Guard Service Charges:</label>
                    <input type="text" id="guard_service_charges" name="guard_service_charges">
                </div>
            </div>

            <div class="form-group">
                <div>
                    <label for="guard_grand_total_per_month">Guard Grand Total per Month:</label>
                    <input type="text" id="guard_grand_total_per_month" name="guard_grand_total_per_month">
                </div>
            </div>

            <button type="submit">Submit</button>

            <div id="notification" class="notification" style="display: none;">Quotation generated Successfully</div>

        </form>
    </div>
</body>



<script>
   

    function calculateGuardTotals() {
        var basicPay = parseFloat(document.getElementById('guard_basic_pay').value) || 0;
        var specialAllowance = parseFloat(document.getElementById('guard_special_allowance').value) || 0;
        var paid_holiday = parseFloat(document.getElementById('guard_paid_holiday').value) || 0;
        var uniform = parseFloat(document.getElementById('guard_uniform').value) || 0;

        var totalA = basicPay + specialAllowance;
        document.getElementById('guard_total_a').value = totalA.toFixed(2);

        var conveyanceAllowance = parseFloat(document.getElementById('guard_conveyance_allowance').value) || 0;
        var educationAllowance = parseFloat(document.getElementById('guard_education_allowance').value) || 0;
        var travellingAllowance = parseFloat(document.getElementById('guard_travelling_allowance').value) || 0;
        var houseDuty = parseFloat(document.getElementById('guard_house_duty').value) || 0;
        var totalB = totalA + conveyanceAllowance + educationAllowance + travellingAllowance + houseDuty;
        document.getElementById('guard_total_b').value = totalB.toFixed(2);

        let washingallowance = parseFloat(document.getElementById('guard_washing_allowance').value) || 0; 

        var hra = 0.05 * totalA;
        document.getElementById('guard_hra').value = hra.toFixed(2);


        let subTotalC = totalB + washingallowance + hra;
        document.getElementById('guard_sub_total_c').value = subTotalC.toFixed(2);

        var pf = 0.13 * totalA;
        document.getElementById('guard_pf').value = pf.toFixed(2);

        var gratuity = 0.0481 * totalA;
        document.getElementById('guard_gratuity').value = gratuity.toFixed(2);

        var leavewithwages = 0;
        document.getElementById('guard_leave_with_wages').value = leavewithwages.toFixed(2);

        var ESIC = 0.0325 * totalA;
        document.getElementById('guard_esic').value = ESIC.toFixed(2);

        let bonus = 0;
        document.getElementById('guard_bonus').value = bonus.toFixed(2);

        var totalC = subTotalC + pf + gratuity + leavewithwages + paid_holiday + ESIC + bonus + uniform ;
        document.getElementById('guard_total_c').value = totalC.toFixed(2);

        let servicecharge = 0.1 * totalC;
        document.getElementById('guard_service_charges').value = servicecharge.toFixed(2);

        let grand_total = totalC + servicecharge;
        document.getElementById('guard_grand_total_per_month').value = grand_total.toFixed(2);
    }

    function updateCalculations() {
        calculateGuardTotals();
        // calculateSupervisorTotals();
    }

    document.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', updateCalculations);
    });


    function showNotification() {
            const notification = document.getElementById('notification');
            notification.style.display = 'block'; // Show the notification
            notification.style.opacity = '1'; // Make it visible

            setTimeout(() => {
                notification.style.opacity = '0'; // Fade out
                setTimeout(() => {
                    notification.style.display = 'none'; // Hide it after fading out
                }, 500); // Match with the transition duration
            }, 3000); // Display for 3 seconds
        }

        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', updateCalculations);
        });
</script>
{% endblock %}